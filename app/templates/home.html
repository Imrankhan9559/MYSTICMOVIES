{% extends "base.html" %}
{% block content %}
{% macro poster_card(item) %}
<div class="group rounded-2xl border border-gray-800 bg-black/70 overflow-hidden hover:border-yellow-500/60 transition">
    <div class="relative aspect-[2/3]">
        {% if item.poster %}
        <img src="{{ item.poster }}" alt="{{ item.title }}" class="h-full w-full object-cover">
        {% else %}
        <div class="h-full w-full bg-gradient-to-br from-gray-900 via-black to-gray-800 flex items-center justify-center">
            <i class="fas fa-film text-yellow-400 text-4xl"></i>
        </div>
        {% endif %}
        <div class="absolute inset-0 bg-gradient-to-t from-black/95 via-black/20 to-transparent"></div>
        <div class="absolute bottom-0 left-0 right-0 p-3">
            <div class="text-[10px] uppercase tracking-widest text-yellow-400">{{ item.type }}</div>
            <div class="text-sm font-semibold text-white line-clamp-2">{{ item.title }}</div>
            {% if item.year %}
            <div class="text-[11px] text-gray-400 mt-1">{{ item.year }}</div>
            {% endif %}
        </div>
        <a href="/content/details/{{ item.slug }}" class="absolute inset-0" aria-label="Open {{ item.title }}"></a>
    </div>
    <div class="p-3 space-y-1">
        {% if item.card_labels and item.card_labels|length > 0 %}
            {% for label in item.card_labels %}
                <div class="text-xs text-gray-500 truncate">{{ label }}</div>
            {% endfor %}
        {% else %}
        <div class="text-xs text-gray-500">No files available.</div>
        {% endif %}
    </div>
</div>
{% endmacro %}

{% set featured = trending[0] if trending and trending|length > 0 else None %}

<section class="relative overflow-hidden rounded-2xl border border-yellow-600/30 bg-gradient-to-r from-black via-gray-950 to-yellow-950 p-6 sm:p-10 mb-8">
    <div class="absolute inset-0 opacity-25 bg-[radial-gradient(circle_at_20%_20%,#facc15_0%,transparent_40%),radial-gradient(circle_at_80%_60%,#f59e0b_0%,transparent_45%)]"></div>
    <div class="relative grid gap-8 lg:grid-cols-[1.15fr,0.85fr] items-center">
        <div>
            <p class="text-yellow-400 uppercase tracking-[0.28em] text-xs font-semibold mb-3">MysticMovies</p>
            <h1 class="text-3xl sm:text-5xl font-extrabold text-white leading-tight">{{ site.hero_title }}</h1>
            <p class="text-gray-300 mt-4 max-w-2xl">{{ site.hero_subtitle }}</p>
            <div class="mt-6 flex flex-wrap gap-3">
                <a href="{{ site.hero_cta_link or '/content' }}" class="inline-flex items-center px-5 py-2.5 rounded-full bg-yellow-400 text-black font-bold hover:bg-yellow-300 transition">
                    <i class="fas fa-play mr-2"></i>{{ site.hero_cta_text or 'Browse Content' }}
                </a>
                {% if user %}
                <a href="/profile" class="inline-flex items-center px-5 py-2.5 rounded-full bg-gray-800 text-gray-100 border border-gray-700 hover:bg-gray-700 transition">
                    <i class="fas fa-user mr-2"></i>My Profile
                </a>
                {% endif %}
            </div>
        </div>
        {% if featured %}
        <div class="lg:ml-auto max-w-sm">
            {{ poster_card(featured) }}
        </div>
        {% endif %}
    </div>
</section>

<section class="mb-10">
    <div class="flex items-center justify-between mb-4">
        <h2 class="text-xl font-bold text-white">Trending Now</h2>
        <a href="/content" class="text-yellow-400 text-sm hover:text-yellow-300">See all</a>
    </div>
    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4">
        {% for item in trending %}
            {{ poster_card(item) }}
        {% endfor %}
    </div>
</section>

<section class="mb-10">
    <div class="flex items-center justify-between mb-4">
        <h2 class="text-xl font-bold text-white">Movies</h2>
        <a href="/content/movies" class="text-yellow-400 text-sm hover:text-yellow-300">View movies</a>
    </div>
    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4">
        {% for item in movies %}
            {{ poster_card(item) }}
        {% endfor %}
    </div>
</section>

<section>
    <div class="flex items-center justify-between mb-4">
        <h2 class="text-xl font-bold text-white">Web Series</h2>
        <a href="/content/web-series" class="text-yellow-400 text-sm hover:text-yellow-300">View series</a>
    </div>
    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4">
        {% for item in series %}
            {{ poster_card(item) }}
        {% endfor %}
    </div>
</section>
{% endblock %}
